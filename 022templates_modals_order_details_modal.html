<!-- admin_orders_management/templates/modals/order_details_modal.html -->
<div class="modal fade" id="orderDetailsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-xl">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title">
                    <i class="fas fa-shopping-cart me-2"></i>
                    Order Details
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="text-center py-5">
                    <div class="loading-spinner"></div>
                    <p class="mt-3">Loading order details...</p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    Close
                </button>
                <button type="button" class="btn btn-primary" onclick="printOrderDetails()">
                    <i class="fas fa-print"></i> Print
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Order Details Template (Hidden) -->
<template id="orderDetailsTemplate">
    <div class="order-details">
        <!-- Order Header -->
        <div class="row mb-4">
            <div class="col-md-8">
                <h4>Order #<span id="orderId"></span></h4>
                <p class="text-muted mb-0">
                    <i class="fas fa-calendar-alt me-1"></i>
                    <span id="orderDate"></span>
                </p>
            </div>
            <div class="col-md-4 text-end">
                <span class="status-badge" id="orderStatusBadge">
                    <i class="fas fa-circle me-1"></i>
                    <span id="orderStatus"></span>
                </span>
            </div>
        </div>
        
        <!-- Customer Information -->
        <div class="card mb-4">
            <div class="card-header">
                <h6 class="mb-0">
                    <i class="fas fa-user me-2"></i>
                    Customer Information
                </h6>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <table class="table table-borderless table-sm">
                            <tr>
                                <th width="40%">Name:</th>
                                <td id="customerName"></td>
                            </tr>
                            <tr>
                                <th>Phone:</th>
                                <td id="customerPhone"></td>
                            </tr>
                            <tr>
                                <th>Email:</th>
                                <td id="customerEmail"></td>
                            </tr>
                        </table>
                    </div>
                    <div class="col-md-6">
                        <p class="mb-1"><strong>Delivery Location:</strong></p>
                        <p id="deliveryLocation" class="text-muted"></p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Order Items -->
        <div class="card mb-4">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h6 class="mb-0">
                    <i class="fas fa-shopping-cart me-2"></i>
                    Order Items (<span id="itemCount">0</span>)
                </h6>
                <span class="badge bg-primary">
                    Total: <span id="orderTotal">₹0.00</span>
                </span>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover mb-0">
                        <thead>
                            <tr>
                                <th width="50">#</th>
                                <th>Item</th>
                                <th class="text-center">Type</th>
                                <th class="text-center">Qty</th>
                                <th class="text-end">Price</th>
                                <th class="text-end">Total</th>
                            </tr>
                        </thead>
                        <tbody id="orderItemsTable">
                            <!-- Items will be inserted here -->
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="5" class="text-end"><strong>Total Amount:</strong></td>
                                <td class="text-end"><strong id="orderTotalFooter">₹0.00</strong></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Order Timeline -->
        <div class="card mb-4">
            <div class="card-header">
                <h6 class="mb-0">
                    <i class="fas fa-history me-2"></i>
                    Order Timeline
                </h6>
            </div>
            <div class="card-body">
                <div class="timeline" id="orderTimeline">
                    <!-- Timeline items will be inserted here -->
                </div>
            </div>
        </div>
        
        <!-- Notes -->
        <div class="card">
            <div class="card-header">
                <h6 class="mb-0">
                    <i class="fas fa-sticky-note me-2"></i>
                    Notes
                </h6>
            </div>
            <div class="card-body">
                <p id="orderNotes" class="mb-0">No notes available.</p>
            </div>
        </div>
    </div>
</template>

<!-- Order Item Template -->
<template id="orderItemTemplate">
    <tr>
        <td class="text-center">{index}</td>
        <td>
            <div class="d-flex align-items-center">
                <img src="{photo}" 
                     alt="{name}" 
                     class="order-item-image me-3 rounded">
                <div>
                    <strong>{name}</strong>
                    {description}
                </div>
            </div>
        </td>
        <td class="text-center">
            <span class="badge bg-secondary">{type}</span>
        </td>
        <td class="text-center">{quantity}</td>
        <td class="text-end">{price}</td>
        <td class="text-end">{total}</td>
    </tr>
</template>

<!-- Timeline Item Template -->
<template id="timelineItemTemplate">
    <div class="timeline-item {status}">
        <div class="timeline-marker {badgeClass}"></div>
        <div class="timeline-content">
            <h6>{title}</h6>
            <p class="text-muted mb-0">{date}</p>
            {notes}
        </div>
    </div>
</template>

<script>
function printOrderDetails() {
    const printWindow = window.open('', '_blank');
    const modalContent = document.querySelector('#orderDetailsModal .modal-body').innerHTML;
    
    printWindow.document.write(`
        <html>
            <head>
                <title>Order Details - Bite Me Buddy</title>
                <style>
                    body { font-family: Arial, sans-serif; margin: 20px; }
                    .order-header { border-bottom: 2px solid #333; padding-bottom: 10px; margin-bottom: 20px; }
                    .status-badge { 
                        display: inline-block; 
                        padding: 5px 10px; 
                        border-radius: 4px; 
                        font-weight: bold; 
                    }
                    .status-pending { background-color: #ffc107; color: #856404; }
                    .status-processing { background-color: #17a2b8; color: white; }
                    .status-completed { background-color: #28a745; color: white; }
                    .status-cancelled { background-color: #dc3545; color: white; }
                    table { width: 100%; border-collapse: collapse; margin: 20px 0; }
                    th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
                    th { background-color: #f2f2f2; }
                    .text-end { text-align: right; }
                    .text-center { text-align: center; }
                </style>
            </head>
            <body>
                <div class="order-header">
                    <h2>Order Details - Bite Me Buddy</h2>
                    <p>Printed: ${new Date().toLocaleString()}</p>
                </div>
                ${modalContent}
            </body>
        </html>
    `);
    
    printWindow.document.close();
    printWindow.focus();
    printWindow.print();
}
</script>